language: ruby
rvm:
- 2.4.1
env:
  global:
  - APP_ENV=production
  - DB_CONNECTION=$DB_CONNECTION
before_script:
- bundle exec rails db:create
- bundle exec rails db:migrate
- bundle exec rails db:seed
script: bundle exec rails test
services: postgresql
stages:
- name: deploy
  if: branch = master
deploy:
  provider: heroku
  api_key:
    secure: TPEVYjEFFt3NaI4EaLk8gqmlnaZOPgFBC4nT3bU3aBCyFBVpPoHqYj7+WH80y7p9m2p9QMVZNnsUuSp0cuYdGmFAqDw4D3dyMKtC0tWLRte4lrY2ikvOViLeKiJswuxLQkYz6C7sCXErjSHz5vRbZq4nm83K8KfUflAySiuf7lQsPCjxusrNIiQRmygaIlMCyhEBe0FMDbDTY6Rlo9RXCKVA+Mx+3bXIZj+sZCP1ONK289aHIy1qjwzNWgstqKLN92gK62nAtmhbIWwaTGjc0ukAv/zJwu9GSnuprWb+VKV1Q3XqDI7AsHX3UV1rGoK3Xn8vXhFQMpsNgSQo1shW0djGofuvESFWhafERGxWD0iXgMwgJjGaNSa+/LEFXDd5qoEH/BWTuiiw4Qb0bzwzi2XjbN0+Niai1z3uffzRlE1k9lBAD+ycKN1Wl8BzXiKrGnKp7GR34l943lfHbHuZ1wv6WatnkCyKsJe0XCte1kG1ySOkKu0biN3tfBidoB7daRoqVr37PaAo0tIdtvCtKIOiyWfwIVkLbtPjnOO1SIiJR5PQO6cGaSjUoDj+S9h4bWTU9qBIpMUV450P9wjZY6KIEbtsPTnoMeTBDXfXNo60ld4ytD0QrqCb1aoyTPdJi4u7GUXkH7POprTfheTNVMSru4THtlT90WQdE1/0LBE=
  app: GiftOfCharityBack
  on:
    repo: Cr0s4k/GiftOfCharityBack
  run:
    - rake db:migrate
    - rake db:seed
